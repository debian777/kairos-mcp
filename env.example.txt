
# ------------------------------------------------------------
# KAIROS MCP — Environment template
# Copy to .env.dev, .env.qa, or .env.prod and uncomment/set as needed.
# ------------------------------------------------------------

############################
# Runtime Basics
############################
# NODE_ENV=development                 # Node environment
# INSTANCE_ID=kairos-dev-1             # Used in metrics labels
# KAIROS_APP_SPACE_ID=space:kairos-app # Default space when auth off; embedded mem docs; included in search for all users

############################
# Transport & Ports
############################
# TRANSPORT_TYPE=http                  # stdio (default) | http
# PORT=3300                            # HTTP server port
# METRICS_PORT=9090                    # Prometheus metrics port

############################
# Logging & Diagnostics
############################
# LOG_LEVEL=info                       # trace | debug | info | warn | error (see docs/logging.md)
# LOG_FORMAT=text                      # text (human-readable) | json (one JSON object per line for aggregation)
# TRANSPORT_TYPE=stdio                 # stdio (default; logs to stderr) | http (logs to stdout)
# STRICT_COVERAGE=false                # true forces 100% coverage

############################
# Cache / Redis Configuration
############################
# REDIS_URL=redis://127.0.0.1:6379     # Set → Redis backend; unset or empty → in-memory (dev without Redis)
# KAIROS_REDIS_PREFIX=kairos:dev:      # Namespacing per env

############################
# Qdrant Vector Store
############################
# QDRANT_URL=http://127.0.0.1:6333     # Qdrant base URL
# QDRANT_COLLECTION=kairos_dev         # Target collection/alias
# QDRANT_API_KEY=                      # Optional API key
# QDRANT_CA_CERT_PATH=/path/ca.pem     # Custom CA for HTTPS
# QDRANT_RESCORE=true                  # true => higher precision search

############################
# Startup Snapshot Controls
############################
# QDRANT_SNAPSHOT_ON_START=false       # Capture snapshot at boot
# QDRANT_SNAPSHOT_DIR=/snapshots       # Default (Docker). Override in dev: ./data/qdrant/snapshots

############################
# Search Behavior
############################
# KAIROS_SEARCH_OVERFETCH_FACTOR=1     # Candidate multiplier before collapse
# KAIROS_SEARCH_MAX_FETCH=200          # Hard fetch ceiling
# KAIROS_ENABLE_GROUP_COLLAPSE=true    # Collapse results by chain ID

############################
# Embedding Provider Selection
############################
# EMBEDDING_PROVIDER=auto              # auto | openai | tei

############################
# TEI (Text Embeddings Inference)
############################
# TEI_BASE_URL=http://127.0.0.1:8080   # TEI endpoint
# TEI_MODEL=Alibaba-NLP/gte-large-en-v1.5
# TEI_DIMENSION=1024                   # Override detected dimension

############################
# OpenAI Embeddings
############################
# OPENAI_API_KEY=sk-proj-xxxxxxxx      # Project or org key
# OPENAI_EMBEDDING_MODEL=text-embedding-3-small
# EMBEDDING_DIMENSION=1536             # Matches provider dimension

############################
# Auth — parameters grouped by AUTH_ENABLED
############################
# See docs/architecture/auth-urls-qa.md for Docker (user vs app→Keycloak URLs).
# One Keycloak per env: .env.dev / .env.qa / .env.prod set KEYCLOAK_URL, KEYCLOAK_REALM, KEYCLOAK_CLIENT_ID.

# --- AUTH_ENABLED=false (default) ---
# No auth. /api and MCP are open. Keycloak/session/callback not required.
# Optional: KAIROS_APP_SPACE_ID (see docs/plans/qdrant-multitenancy.md).

# --- AUTH_ENABLED=true ---
# Require auth for /api: redirect browser to Keycloak, 401 with login_url for API clients.
# Startup fails if any required auth var is missing.
# AUTH_ENABLED=true
# SESSION_SECRET=your-secret-min-32-chars
# SESSION_MAX_AGE_SEC=604800   (optional; session/cookie lifetime in seconds, default 7 days)
# For long-lived browser sessions, align Keycloak realm ssoSessionIdleTimeout/ssoSessionMaxLifespan (scripts/keycloak/import/*.json) with this value. Bearer token TTL is configured in Keycloak (realm/client token settings), not here.
# AUTH_CALLBACK_BASE_URL=http://localhost:3300
#   dev:  http://localhost:3300  |  qa:  http://localhost:3500  |  prod: https://your-domain.example
# KEYCLOAK_URL=http://localhost:8080
# KEYCLOAK_REALM=kairos-dev
# KEYCLOAK_CLIENT_ID=kairos-mcp
# KEYCLOAK_INTERNAL_URL=   (optional; server-side token exchange e.g. http://keycloak:8080 in Docker)
# Bearer token validation (MCP OAuth):
# AUTH_MODE=oidc_bearer
# AUTH_TRUSTED_ISSUERS=http://localhost:8080/realms/kairos-dev
# AUTH_ALLOWED_AUDIENCES=kairos-mcp
# AUTH_TRACE=true   (dev only; dump raw Bearer JWT payloads to .kairos-dev.log)
# Dev tip: use the same Keycloak base URL in all browsers (e.g. http://localhost:8080, not 127.0.0.1).

# --- Keycloak / Postgres (when using Keycloak) ---
# Compose (infra:up uses .env.dev): set in .env.dev so no separate .env is needed.
# Regenerate secrets: python3 scripts/generate_dev_secrets.py [--ci] [--force].
# KEYCLOAK_DB_PASSWORD=
# KEYCLOAK_ADMIN_USERNAME=admin
# KEYCLOAK_ADMIN_PASSWORD=
# Never commit real secrets.

############################
# Advanced / Ops Flags
############################
# TRUSTED_PROXY_CIDRS=10.0.0.0/8,192.168.0.0/16


