
# ------------------------------------------------------------
# KAIROS MCP ENVIRONMENT TEMPLATE
# Copy this file (e.g., to .env.dev/.env.qa) and uncomment
# values that need overriding. Defaults are commented.
# ------------------------------------------------------------

############################
# Runtime Basics
############################
# NODE_ENV=development                 # Node environment
# INSTANCE_ID=kairos-dev-1             # Used in metrics labels
# DEFAULT_TENANT_ID=default            # Fallback tenant when unspecified
# DEFAULT_SPACE_ID=space:default       # Space when auth disabled or no request (multitenancy)

############################
# Transport & Ports
############################
# TRANSPORT_TYPE=http                  # http only
# HTTP_ENABLED=true                    # Enable HTTP transport
# PORT=3300                            # HTTP server port
# METRICS_PORT=9090                    # Prometheus metrics port

############################
# Logging & Diagnostics
############################
# LOG_LEVEL=info                       # info | debug
# LOG_FORMAT=text                      # text | json
# MCP_DEBUG=false                      # Verbose MCP tool logging
# STRICT_COVERAGE=false                # true forces 100% coverage

############################
# Redis Configuration
############################
# REDIS_URL=redis://127.0.0.1:6379     # Redis connection string
# KAIROS_REDIS_PREFIX=kairos:dev:      # Namespacing per env

############################
# Qdrant Vector Store
############################
# QDRANT_URL=http://127.0.0.1:6333     # Qdrant base URL
# QDRANT_COLLECTION=kairos_dev         # Target collection/alias
# QDRANT_API_KEY=                      # Optional API key
# QDRANT_CA_CERT_PATH=/path/ca.pem     # Custom CA for HTTPS
# QDRANT_RESCORE=true                  # true => higher precision search

############################
# Startup Snapshot Controls
############################
# QDRANT_SNAPSHOT_ON_START=false       # Capture snapshot at boot
# QDRANT_SNAPSHOT_DIR=./data/qdrant/snapshots  # Snapshot output directory

############################
# Search Behavior
############################
# KAIROS_SEARCH_OVERFETCH_FACTOR=1     # Candidate multiplier before collapse
# KAIROS_SEARCH_MAX_FETCH=200          # Hard fetch ceiling
# KAIROS_ENABLE_GROUP_COLLAPSE=true    # Collapse results by chain ID

############################
# Embedding Provider Selection
############################
# EMBEDDING_PROVIDER=auto              # auto | openai | tei
# BATCH_SIZE=100                       # Chunk size for ingestion

############################
# TEI (Text Embeddings Inference)
############################
# TEI_BASE_URL=http://127.0.0.1:8080   # TEI endpoint
# TEI_MODEL=Alibaba-NLP/gte-large-en-v1.5
# TEI_DIMENSION=1024                   # Override detected dimension

############################
# OpenAI Embeddings
############################
# OPENAI_API_KEY=sk-proj-xxxxxxxx      # Project or org key
# OPENAI_EMBEDDING_MODEL=text-embedding-3-small
# EMBEDDING_DIMENSION=1536             # Matches provider dimension

############################
# Docker Compose (volumes)
############################
# VOLUME_LOCAL_PATH=./data             # Host path for redis/qdrant/keycloak data

############################
# Postgres (compose profile infra/prod) — Keycloak DB only
############################
# Default Docker workflow: POSTGRES_USER=keycloak, POSTGRES_DB=keycloak, POSTGRES_PASSWORD=KEYCLOAK_DB_PASSWORD.
# Regenerate: scripts/generate-dev-secrets.sh (writes .env.prod; syncs to .env).
# Run: docker compose --env-file .env.prod --profile infra up -d
# KEYCLOAK_DB_PASSWORD=

# App / dev profile (see env.dev.example)
# KEYCLOAK_DEV_URL=http://localhost:8080
# KEYCLOAK_DEV_REALM=kairos-dev
# KEYCLOAK_QA_REALM=kairos-qa
# KEYCLOAK_PROD_REALM=kairos-prod
# KEYCLOAK_DEV_CLIENT_ID=kairos-mcp
# QA auth tests (ENV=qa): set KEYCLOAK_QA_URL in .env.qa (e.g. http://localhost:8080). Tests use app on port 3500.
# KEYCLOAK_QA_URL=...
# KEYCLOAK_QA_REALM=kairos-qa
# KEYCLOAK_QA_CLIENT_ID=kairos-mcp
# Keycloak admin (dev only): admin / admin — never use in production.
# In .env (not committed): KEYCLOAK_ADMIN_PASSWORD. Dev/qa test user is hardcoded: kairos-tester / kairos-tester-secret.
# Auth integration tests: dev uses KEYCLOAK_DEV_URL and spawns server on 3301; qa uses KEYCLOAK_QA_URL and existing server on 3500.
# kairos-tester via Admin API. Set these if your Keycloak admin password is not 'admin':
# KEYCLOAK_DEV_ADMIN_USERNAME=admin
# KEYCLOAK_DEV_ADMIN_PASSWORD=your-keycloak-admin-password

# Require auth for /api: redirect browser to Keycloak, 401 with login_url for API clients
# AUTH_ENABLED=true
# SESSION_SECRET=your-secret-min-32-chars
# AUTH_CALLBACK_BASE_URL is required when AUTH_ENABLED=true (no default in code). Examples:
#   dev:  AUTH_CALLBACK_BASE_URL=http://localhost:3300
#   qa:   AUTH_CALLBACK_BASE_URL=http://localhost:3500
#   prod: AUTH_CALLBACK_BASE_URL=https://your-domain.example
# Keycloak URL/realm/client from KEYCLOAK_DEV_URL, KEYCLOAK_DEV_REALM, KEYCLOAK_DEV_CLIENT_ID above
# Dev tip: use the same Keycloak base URL in all browsers (e.g. always http://localhost:8080, not 127.0.0.1) to avoid SSO session confusion when logged in from 2+ browsers.

# Bearer token validation (required for MCP OAuth when AUTH_ENABLED=true)
# AUTH_MODE=oidc_bearer
# AUTH_TRUSTED_ISSUERS=http://localhost:8080/realms/kairos-dev
# AUTH_ALLOWED_AUDIENCES=kairos-mcp
# AUTH_TRACE=true to dump raw Bearer JWT payloads to .kairos-dev.log (dev only).
# See docs/plans/qdrant-multitenancy.md for space model and DEFAULT_SPACE_ID.

############################
# Advanced / Ops Flags
############################
# TRUSTED_PROXY_CIDRS=10.0.0.0/8,192.168.0.0/16


